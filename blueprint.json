{
  "$schema": "https://playground.wordpress.net/blueprint-schema.json",
  "landingPage": "/wp-admin/edit.php",
  "preferredVersions": {
    "php": "8.2",
    "wp": "latest"
  },
  "features": {
    "networking": true
  },
  "steps": [
    {
      "step": "login",
      "username": "admin",
      "password": "password"
    },
    {
      "step": "installPlugin",
      "pluginData": {
        "resource": "url",
        "url": "https://github.com/dnnsjsk/tailwindwp/archive/refs/heads/main.zip"
      }
    },
    {
      "step": "setSiteOptions",
      "options": {
        "blogname": "TailwindWP Demo"
      }
    },
    {
      "step": "mkdir",
      "path": "/wordpress/wp-content/mu-plugins"
    },
    {
      "step": "writeFile",
      "path": "/wordpress/wp-content/mu-plugins/create-demo-post.php",
      "data": "<?php\nadd_action('init', function() {\n    if (!is_admin()) return;\n    if (get_option('tailwindwp_redirected')) return;\n    $post_id = get_option('tailwindwp_demo_post_id');\n    if (!$post_id) {\n        $content = '<!-- wp:group {\"tailwindClasses\":\"bg-linear-to-br from-blue-500 to-purple-600 p-8 rounded-2xl shadow-xl max-w-2xl mx-auto my-12\"} --><div class=\"wp-block-group bg-linear-to-br from-blue-500 to-purple-600 p-8 rounded-2xl shadow-xl max-w-2xl mx-auto my-12\"><!-- wp:heading {\"tailwindClasses\":\"text-white text-3xl font-bold mb-4\"} --><h2 class=\"wp-block-heading text-white text-3xl font-bold mb-4\">Welcome to TailwindWP</h2><!-- /wp:heading --><!-- wp:paragraph {\"tailwindClasses\":\"text-blue-100 text-lg leading-relaxed\"} --><p class=\"text-blue-100 text-lg leading-relaxed\">This demo shows TailwindCSS classes working directly in WordPress. No CDN, no build step - all CSS is generated server-side by TailwindPHP. Try editing the Tailwind Classes in the sidebar!</p><!-- /wp:paragraph --></div><!-- /wp:group -->';\n        $post_id = wp_insert_post(['post_title' => 'TailwindWP Demo', 'post_status' => 'publish', 'post_content' => $content]);\n        update_option('tailwindwp_demo_post_id', $post_id);\n    }\n    update_option('tailwindwp_redirected', true);\n    wp_redirect(admin_url('post.php?post=' . $post_id . '&action=edit'));\n    exit;\n});\nadd_action('after_setup_theme', function() {\n    global $pagenow;\n    if (!is_admin() || $pagenow !== 'post.php') return;\n    $post_id = isset($_GET['post']) ? (int)$_GET['post'] : 0;\n    if (!$post_id) return;\n    $post = get_post($post_id);\n    if (!$post) return;\n    $blocks = parse_blocks($post->post_content);\n    $classes = [];\n    $extract = function($blocks) use (&$extract, &$classes) {\n        foreach ($blocks as $block) {\n            if (!empty($block['attrs']['tailwindClasses'])) {\n                $classes = array_merge($classes, explode(' ', $block['attrs']['tailwindClasses']));\n            }\n            if (!empty($block['innerBlocks'])) $extract($block['innerBlocks']);\n        }\n    };\n    $extract($blocks);\n    if (empty($classes)) return;\n    add_action('plugins_loaded', function() use ($classes) {\n        if (!function_exists('tailwindwp_generate_css')) return;\n        $css = tailwindwp_generate_css(array_unique($classes), ['scope' => '.editor-styles-wrapper']);\n        $upload_dir = wp_upload_dir();\n        $css_file = $upload_dir['basedir'] . '/tailwindwp-preload.css';\n        file_put_contents($css_file, $css);\n        add_editor_style($upload_dir['baseurl'] . '/tailwindwp-preload.css');\n    });\n});"
    }
  ]
}
